#!/usr/bin/env ruby

require 'ipaddr'

ips, opts = ARGV.partition do |s|
  begin
    IPAddr.new(s)
  rescue IPAddr::InvalidAddressError
    false
  end
end

if ips.size < 1
  STDERR.puts "usage: #{$0} ip-addr [dig-opt...]"
  exit 1
end

reversed = ips.map { |s| IPAddr.new(s).reverse }

exec("dig PTR #{reversed.join(" ")} #{opts.join(" ")}")
